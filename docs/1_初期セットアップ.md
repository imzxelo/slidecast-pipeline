# 初期セットアップガイド

このガイドでは、Slidecast Pipelineを使えるようにするための初期設定を説明します。

この作業は**最初の1回だけ**行えばOKです。
2回目以降は、この作業は不要です。

---

## 目次

1. [ファイルをダウンロードする](#1-ファイルをダウンロードする)
2. [ファイルを展開（解凍）する](#2-ファイルを展開解凍する)
3. [セットアップを実行する](#3-セットアップを実行する)
4. [セットアップが完了したか確認する](#4-セットアップが完了したか確認する)

---

## 1. ファイルをダウンロードする

### このステップの目的

Slidecast Pipelineのプログラムファイルを、あなたのパソコンにダウンロードします。

### 手順

#### 方法A: ZIPファイルでダウンロードする場合

1. Makotoから送られたダウンロードリンクをクリックします

2. 「Code」という緑色のボタンをクリックします

   <!-- TODO: スクリーンショット - GitHubのCodeボタン -->

3. 「Download ZIP」をクリックします

   <!-- TODO: スクリーンショット - Download ZIPの位置 -->

4. ダウンロードが完了するまで待ちます
   （ファイルサイズによっては数分かかる場合があります）

5. ダウンロードしたファイルは、通常「ダウンロード」フォルダに保存されます

#### 方法B: Makotoから直接ZIPファイルを受け取った場合

1. 受け取ったZIPファイルを「ダウンロード」フォルダに保存します

---

## 2. ファイルを展開（解凍）する

### このステップの目的

ダウンロードしたZIPファイルは「圧縮」された状態です。
これを「展開（解凍）」することで、中のファイルを使えるようにします。

### 手順

1. **エクスプローラーを開きます**

   画面下のタスクバーにある、フォルダのアイコンをクリックします。

   <!-- TODO: スクリーンショット - タスクバーのエクスプローラーアイコン -->

2. **「ダウンロード」フォルダを開きます**

   左側のメニューから「ダウンロード」をクリックします。

   <!-- TODO: スクリーンショット - エクスプローラーの左側メニュー -->

3. **ZIPファイルを探します**

   `slidecast-pipeline-main.zip` という名前のファイルを探します。

   <!-- TODO: スクリーンショット - ZIPファイルの見た目 -->

4. **ZIPファイルを右クリックします**

5. **「すべて展開」をクリックします**

   <!-- TODO: スクリーンショット - 右クリックメニューの「すべて展開」 -->

6. **展開先を選びます**

   展開先を聞かれたら、以下のように入力してください：

   ```
   C:\
   ```

   ⚠️ **重要**: `C:\` だけを指定してください（slidecast-pipeline は付けない）

   <!-- TODO: スクリーンショット - 展開先の設定画面 -->

7. **「展開」ボタンをクリックします**

8. **展開が完了するまで待ちます**

   完了すると、展開先のフォルダが自動で開きます。

9. **フォルダ名を変更します（重要！）**

   展開すると `slidecast-pipeline-main` というフォルダができます。
   このフォルダ名を `slidecast-pipeline` に変更してください。

   **変更方法:**
   1. `slidecast-pipeline-main` フォルダを右クリック
   2. 「名前の変更」をクリック
   3. `slidecast-pipeline` と入力してEnter

   <!-- TODO: スクリーンショット - フォルダ名変更 -->

### 確認

フォルダ名変更が完了すると、以下の場所にフォルダがあるはずです：

```
C:\slidecast-pipeline\
├── docs/           ← ドキュメントフォルダ
├── editor/         ← エディタのファイル
├── bin/            ← プログラムファイル
├── README.md       ← 説明書
├── setup.ps1       ← セットアップ用ファイル（次のステップで使います）
├── start.bat       ← アプリ起動用ファイル
└── その他のファイル
```

<!-- TODO: スクリーンショット - 展開後のフォルダの中身 -->

---

## 3. セットアップを実行する

### このステップの目的

Slidecast Pipelineを動かすために必要なソフトウェアを、自動でインストールします。

インストールされるソフトウェア：
- **Node.js**: このアプリを動かすためのプログラム実行環境
- **ffmpeg**: 動画を作成するためのツール
- **poppler**: PDFを画像に変換するためのツール

これらは、セットアップスクリプトが自動でインストールしてくれます。

### 手順

> ⚠️ **重要**: Windowsの初期設定ではPowerShellスクリプトの実行が制限されています。
> 以下の手順に従って、管理者権限でPowerShellを起動してから実行してください。

1. **PowerShellを管理者として起動します**

   1. スタートメニューを開きます（Windowsキーを押す）
   2. 「PowerShell」と入力して検索します
   3. 「Windows PowerShell」が表示されたら、**右クリック**します
   4. **「管理者として実行」** をクリックします

   <!-- TODO: スクリーンショット - PowerShell管理者として実行 -->

   「このアプリがデバイスに変更を加えることを許可しますか？」と表示されたら「はい」をクリックします。

2. **slidecast-pipelineフォルダに移動します**

   PowerShellの黒い画面が開いたら、以下のコマンドを入力してEnterキーを押します：

   ```powershell
   cd C:\slidecast-pipeline
   ```

3. **スクリプト実行を許可します**

   以下のコマンドを入力してEnterキーを押します：

   ```powershell
   Set-ExecutionPolicy Bypass -Scope Process -Force
   ```

   > 💡 これは「このPowerShellウィンドウの間だけ」スクリプト実行を許可する設定です。
   > パソコン全体の設定は変わらないので、安全です。

4. **セットアップを実行します**

   以下のコマンドを入力してEnterキーを押します：

   ```powershell
   .\setup.ps1
   ```

5. **セットアップが完了するまで待ちます**

   画面にインストールの進行状況が表示されます。

   ```
   ========================================
    Slidecast Pipeline セットアップ開始
   ========================================

   これから必要なソフトウェアをインストールします。
   インターネット接続が必要です。
   完了まで5〜10分程度かかる場合があります。
   ```

   途中でいくつかの質問が表示される場合がありますが、
   基本的に「Y」を入力してEnterを押せばOKです。

6. **「セットアップが完了しました！」と表示されたら成功です**

   ```
   ========================================
    セットアップが完了しました！
   ========================================
   ```

   <!-- TODO: スクリーンショット - セットアップ完了画面 -->

7. **Enterキーを押してウィンドウを閉じます**

8. **パソコンを再起動します（重要！）**

   > ⚠️ セットアップ後は必ずパソコンを再起動してください。
   > 再起動しないと、インストールしたツール（ffmpeg、poppler）が正しく動作しません。

---

## 4. セットアップが完了したか確認する

### このステップの目的

セットアップが正しく完了したかを確認します。

### 手順

1. **slidecast-pipelineフォルダを開きます**

2. **`start.bat` をダブルクリックします**

   <!-- TODO: スクリーンショット - start.batファイルの位置 -->

3. **黒いウィンドウが表示され、ブラウザが開きます**

   正常に動作している場合：
   - 黒いウィンドウ（コマンドプロンプト）が表示されます
   - 数秒後に、Chromeブラウザが自動で開きます
   - ブラウザに「Slide Sync Editor」という画面が表示されます

   <!-- TODO: スクリーンショット - アプリ起動後の画面 -->

4. **確認できたら、一旦アプリを終了します**

   黒いウィンドウを閉じると、アプリが終了します。

### うまくいかない場合

#### setup.ps1を実行すると一瞬で画面が閉じる

**原因**: Windowsの「実行ポリシー」でスクリプト実行がブロックされています。

**解決方法**:
1. PowerShellを**管理者として**起動してください
2. 以下のコマンドを順番に実行してください：

```powershell
cd C:\slidecast-pipeline
Set-ExecutionPolicy Bypass -Scope Process -Force
.\setup.ps1
```

#### PDF読み込み時に「undefined」エラーが出る

**原因**: セットアップ後にパソコンを再起動していないため、popplerツールが認識されていません。

**解決方法**: パソコンを再起動してから、再度お試しください。

#### ブラウザが自動で開かない場合

手動でブラウザを開いて、以下のアドレスを入力してください：

```
http://localhost:3001
```

#### その他のエラーが表示される場合

Makotoに連絡してください。エラーメッセージをスクリーンショットで送っていただけると、対応がスムーズです。

---

## 次のステップ

セットアップが完了したら、次は「API設定」を行います。

→ [2_API設定ガイド.md](2_API設定ガイド.md) に進んでください

---

## よくある質問

### Q: 「ディレクトリが見つかりません」というエラーが出る

フォルダ名が `slidecast-pipeline-main` のままになっている可能性があります。
`C:\slidecast-pipeline` に名前を変更してください。

詳しくは「[2. ファイルを展開（解凍）する](#2-ファイルを展開解凍する)」のステップ9を確認してください。

### Q: セットアップは毎回必要ですか？

いいえ、**最初の1回だけ**で大丈夫です。
2回目以降は、`start.bat` をダブルクリックするだけでアプリが起動します。

### Q: パソコンを再起動したらどうなりますか？

問題ありません。
再起動後も、`start.bat` をダブルクリックすればアプリが起動します。

### Q: アンインストールしたい場合は？

slidecast-pipelineフォルダを削除すればOKです。
ただし、インストールしたソフトウェア（Node.js、ffmpeg、poppler）は残ります。
これらも削除したい場合は、Makotoに連絡してください。

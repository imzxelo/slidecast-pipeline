# 使い方ガイド

このガイドでは、Slidecast Pipelineの日常的な操作方法を説明します。

---

## 目次

1. [アプリを起動する](#1-アプリを起動する)
2. [PDFファイルをアップロードする](#2-pdfファイルをアップロードする)
3. [音声ファイルをアップロードする](#3-音声ファイルをアップロードする)
4. [AI自動マーカー生成を使う](#4-ai自動マーカー生成を使う)
5. [マーカーを手動で編集する](#5-マーカーを手動で編集する)
6. [動画を生成する](#6-動画を生成する)
7. [アプリを終了する](#7-アプリを終了する)
8. [便利な機能](#8-便利な機能)
9. [困ったときは](#9-困ったときは)

---

## 1. アプリを起動する

### 手順

1. **slidecast-pipelineフォルダを開きます**

   セットアップ時に展開したフォルダを開いてください。

   例: `C:\slidecast-pipeline`

2. **`start.bat` をダブルクリックします**

   <!-- TODO: スクリーンショット - start.batファイル -->

3. **黒いウィンドウが表示されます**

   このウィンドウは、アプリを使用中は**開いたまま**にしてください。
   閉じるとアプリが停止します。

   ```
   ========================================
    Slidecast Pipeline を起動しています...
   ========================================
   ```

4. **ブラウザが自動で開きます**

   数秒後に、Google Chromeが自動で開き、「Slide Sync Editor」という画面が表示されます。

   <!-- TODO: スクリーンショット - アプリのメイン画面 -->

   **ブラウザが自動で開かない場合:**

   Chromeを手動で開いて、以下のアドレスを入力してください：

   ```
   http://localhost:3001
   ```

---

## 2. PDFファイルをアップロードする

### このステップの目的

動画にしたいスライド（PDFファイル）をアプリに読み込ませます。

### 手順

1. **「PDFを選択」ボタンをクリックします**

   画面左上にある「PDFを選択」ボタンをクリックします。

   <!-- TODO: スクリーンショット - PDFを選択ボタンの位置 -->

2. **PDFファイルを選びます**

   ファイル選択画面が開きます。
   動画にしたいスライドのPDFファイルを選んで、「開く」をクリックします。

   <!-- TODO: スクリーンショット - ファイル選択画面 -->

3. **PDFが読み込まれます**

   読み込みが完了すると：
   - 画面中央にスライドが表示されます
   - 画面右側にサムネイル（小さいスライド画像）が表示されます

   <!-- TODO: スクリーンショット - PDF読み込み後の画面 -->

4. **（AI機能有効の場合）PDF分析が自動で始まります**

   API設定が完了している場合、PDFを読み込むと自動でAI分析が始まります。
   「PDF分析中...」→「PDF分析完了」と表示されます。

---

## 3. 音声ファイルをアップロードする

### このステップの目的

スライドに合わせるナレーション（音声ファイル）をアプリに読み込ませます。

### 対応している音声形式

- MP3（.mp3）
- M4A（.m4a）
- WAV（.wav）

### 手順

1. **「音声を選択」ボタンをクリックします**

   画面左上にある「音声を選択」ボタンをクリックします。

   <!-- TODO: スクリーンショット - 音声を選択ボタンの位置 -->

2. **音声ファイルを選びます**

   ファイル選択画面が開きます。
   ナレーションの音声ファイルを選んで、「開く」をクリックします。

3. **音声が読み込まれます**

   読み込みが完了すると：
   - 画面下部にオーディオプレーヤーが表示されます
   - 再生ボタン（▶）をクリックすると音声を再生できます

   <!-- TODO: スクリーンショット - 音声読み込み後の画面 -->

4. **（AI機能有効の場合）文字起こしが自動で始まります**

   API設定が完了している場合、音声を読み込むと自動で文字起こしが始まります。
   「文字起こし中...」→「文字起こし完了」と表示されます。

---

## 4. AI自動マーカー生成を使う

### このステップの目的

AIが、スライドの内容と音声を分析して、最適なスライド切り替えタイミングを自動で提案してくれます。

### 前提条件

- API設定が完了していること
- PDFと音声の両方がアップロードされていること
- PDF分析と文字起こしが完了していること

### 手順

1. **PDF分析と文字起こしが完了するのを待ちます**

   画面上部に以下のように表示されます：
   - 「PDF分析完了」
   - 「文字起こし完了」

   <!-- TODO: スクリーンショット - 分析完了の表示 -->

2. **「AI自動マーカー生成」ボタンをクリックします**

   <!-- TODO: スクリーンショット - AI自動マーカー生成ボタン -->

3. **マーカー生成を待ちます**

   「マーカー生成中...」と表示されます。
   数十秒〜数分かかる場合があります。

4. **生成されたマーカーが自動で適用されます**

   完了すると、画面右側の「マーカー一覧」に、AIが提案したマーカーが表示されます。

   <!-- TODO: スクリーンショット - マーカー一覧 -->

5. **必要に応じて微調整します**

   AIの提案は完璧ではない場合があります。
   次のセクション「マーカーを手動で編集する」を参考に、必要に応じて調整してください。

---

## 5. マーカーを手動で編集する

### マーカーとは？

「マーカー」は、スライドを切り替えるタイミングを記録したものです。
例えば：
- 0秒: スライド1を表示
- 30秒: スライド2に切り替え
- 65秒: スライド3に切り替え
- ...

### マーカーを追加する

1. **音声を再生して、スライドを切り替えたい位置で一時停止します**

   オーディオプレーヤーの再生ボタン（▶）をクリックして再生します。
   切り替えたいタイミングで、一時停止ボタン（⏸）をクリックします。

   <!-- TODO: スクリーンショット - オーディオプレーヤー -->

2. **表示したいスライドを選びます**

   画面右側のサムネイルから、表示したいスライドをクリックします。

3. **「マーカー追加」ボタンをクリックします**

   または、キーボードの **M** キーを押しても追加できます。

   <!-- TODO: スクリーンショット - マーカー追加ボタン -->

4. **マーカーが追加されます**

   画面右側の「マーカー一覧」に、追加したマーカーが表示されます。
   自動的に次のスライドに移動します。

### マーカーを削除する

1. **削除したいマーカーを探します**

   画面右側の「マーカー一覧」から、削除したいマーカーを探します。

2. **「×」ボタンをクリックします**

   各マーカーの右側にある「×」ボタンをクリックすると、そのマーカーが削除されます。

   <!-- TODO: スクリーンショット - マーカー削除ボタン -->

### マーカーの時間を微調整する

1. **調整したいマーカーの時間をクリックします**

2. **新しい時間を入力します**

   秒数を直接入力できます。

---

## 6. 動画を生成する

### 前提条件

- PDFがアップロードされていること
- 音声がアップロードされていること
- マーカーが設定されていること（最低1つ）

### 手順

1. **「動画を生成」ボタンをクリックします**

   画面上部にある「動画を生成」ボタンをクリックします。

   <!-- TODO: スクリーンショット - 動画を生成ボタン -->

2. **生成を待ちます**

   ローディング画面が表示されます。
   進捗率（%）とステータスが表示されます。

   ```
   動画を生成しています...
   進捗: 45%
   処理中: 音声と映像を合成しています
   ```

   <!-- TODO: スクリーンショット - ローディング画面 -->

   **注意**: 動画の長さによっては、数分〜10分以上かかる場合があります。
   この間、ブラウザや黒いウィンドウを閉じないでください。

3. **ダウンロードリンクが表示されます**

   生成が完了すると、ダウンロードリンクが表示されます。
   「ダウンロード」をクリックして、動画ファイルを保存します。

   <!-- TODO: スクリーンショット - ダウンロードリンク -->

4. **保存先を選びます**

   保存先を聞かれたら、わかりやすい場所（デスクトップなど）を選んでください。

5. **動画を確認します**

   保存した動画ファイルをダブルクリックして、正しく再生されるか確認してください。

---

## 7. アプリを終了する

### 手順

1. **ブラウザのタブを閉じます**

   Chrome のタブの「×」ボタンをクリックします。

2. **黒いウィンドウを閉じます**

   起動時に表示された黒いウィンドウ（コマンドプロンプト）の「×」ボタンをクリックします。

   または、キーボードで任意のキーを押してから閉じます。

---

## 8. 便利な機能

### キーボードショートカット

| キー | 機能 |
|------|------|
| M | マーカーを追加 |
| スペース | 音声の再生/一時停止 |
| ← | 音声を5秒戻す |
| → | 音声を5秒進める |

### マーカーの保存（バックアップ）

作成したマーカーは、JSONファイルとして保存できます。

1. 「エクスポート」ボタンをクリック
2. `markers.json` ファイルがダウンロードされます

### マーカーの読み込み

以前保存したマーカーを読み込むことができます。

1. 「インポート」ボタンをクリック
2. 保存した `markers.json` ファイルを選択

---

## 9. 困ったときは

### ブラウザが開かない

**対処法:**
1. Chromeを手動で開く
2. アドレスバーに `http://localhost:3001` と入力してEnter

### 「接続できません」と表示される

**対処法:**
1. 黒いウィンドウが開いているか確認
2. 閉じていたら、`start.bat` をダブルクリックしてやり直し

### 動画生成が途中で止まる

**対処法:**
1. しばらく待ってみる（長い動画は10分以上かかることがあります）
2. それでも進まない場合は、アプリを再起動してやり直し

### AI機能が動かない

**対処法:**
1. [API設定ガイド](2_API設定ガイド.md) を確認
2. `.env` ファイルにAPIキーが正しく設定されているか確認
3. アプリを再起動

### 起動時に「Node.js のバージョンが古すぎます」と出る

**対処法:**
1. `setup.ps1` をもう一度実行して、Node.js (LTS) をインストール
2. それでも直らない場合は、PCを再起動してから再度 `start.bat` を起動

### 起動時に「pdftoppm が見つかりません」と出る

**対処法:**
1. `setup.ps1` を実行して poppler をインストール
2. 直らない場合は、PCを再起動（PATH反映待ちの可能性があります）
3. それでも直らない場合は Makoto に連絡

### OpenAI/Gemini のエラー詳細を確認したい

ブラウザで以下を開くと、設定状況が確認できます：

```
http://localhost:3001/api/health
```

### 上記で解決しない場合

Makotoに連絡してください。
その際、以下の情報があると対応がスムーズです：

- 何をしようとしたか
- どんなエラーメッセージが表示されたか（スクリーンショットがあれば最高）
- いつから問題が発生しているか

---

## クイックリファレンス（操作早見表）

### 毎回の作業フロー

```
1. start.bat をダブルクリック（アプリ起動）
      ↓
2. PDFをアップロード
      ↓
3. 音声をアップロード
      ↓
4. AI自動マーカー生成 or 手動でマーカー設定
      ↓
5. 必要に応じてマーカーを微調整
      ↓
6. 「動画を生成」をクリック
      ↓
7. 完成した動画をダウンロード
      ↓
8. ブラウザと黒いウィンドウを閉じる（アプリ終了）
```
